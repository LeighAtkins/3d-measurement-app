(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[42],{627:(e,t,r)=>{"use strict";var n=r(7192);r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},1412:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var n=r(3365),s=r(1521),a=r(627),o=r(7535);function i(){let{user:e,loading:t}=(0,o.As)(),r=(0,a.useRouter)();return(0,s.useEffect)(()=>{if(!t){if(!e)return void r.push("/login");if("COMPANY_ADMIN"===e.role||"COMPANY_USER"===e.role){var n;(null==(n=e.company)?void 0:n.subdomain)?r.push("/company/".concat(e.company.subdomain,"/orders")):r.push("/login?error=no-company")}else r.push("/login?error=unauthorized")}},[e,t,r]),(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,n.jsx)("p",{children:"Redirecting to your company dashboard..."})]})})}},7268:(e,t,r)=>{"use strict";r.d(t,{R2:()=>i,gH:()=>c});var n=r(8660);class s{setToken(e){this.token=e,e?localStorage.setItem("auth_token",e):localStorage.removeItem("auth_token")}getToken(){if(this.token)return this.token;{let e=localStorage.getItem("auth_token");if(e&&this.isTokenValid(e))return this.token=e,e}return null}isTokenValid(e){try{let t=JSON.parse(atob(e.split(".")[1]));return 1e3*t.exp>Date.now()}catch(e){return!1}}handleUnauthorized(){this.setToken(null),window.location.href="/login"}transformError(e){var t,r;let n={error:"Unknown error",status:(null==(t=e.response)?void 0:t.status)||500};return(null==(r=e.response)?void 0:r.data)?(n.error=e.response.data.error||e.response.data.message||e.message,n.message=e.response.data.message,n.details=e.response.data.details):e.message&&(n.error=e.message),n}async get(e,t){return(await this.client.get(e,t)).data}async post(e,t,r){return(await this.client.post(e,t,r)).data}async put(e,t,r){return(await this.client.put(e,t,r)).data}async delete(e,t){return(await this.client.delete(e,t)).data}constructor(e="http://localhost:8000"){this.token=null,this.client=n.A.create({baseURL:e,timeout:3e4,headers:{"Content-Type":"application/json"}}),this.client.interceptors.request.use(e=>(this.token&&(e.headers.Authorization="Bearer ".concat(this.token)),e)),this.client.interceptors.response.use(e=>e,e=>{var t;throw(null==(t=e.response)?void 0:t.status)===401&&this.handleUnauthorized(),this.transformError(e)})}}let a=new s;class o{async signin(e){return this.client.post("/api/auth/signin",{email:e})}async verify(e,t){let r="/api/auth/verify?token=".concat(encodeURIComponent(e),"&email=").concat(encodeURIComponent(t)),n=await this.client.get(r);return n.token&&this.client.setToken(n.token),n}logout(){this.client.setToken(null),window.location.href="/login"}getCurrentUser(){let e=this.client.getToken();if(!e)return null;try{let t=JSON.parse(atob(e.split(".")[1]));return{id:t.userId,email:t.email,role:t.role,companyId:t.companyId}}catch(e){return null}}isAuthenticated(){return null!==this.client.getToken()}constructor(e=a){this.client=e}}let i=new o;class l{async list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new URLSearchParams;t.page&&r.append("page",t.page.toString()),t.limit&&r.append("limit",t.limit.toString()),t.status&&r.append("status",t.status);let n=r.toString(),s="/api/company/".concat(e,"/orders").concat(n?"?".concat(n):"");return this.client.get(s)}async get(e,t){return this.client.get("/api/company/".concat(e,"/orders/").concat(t))}async listClientOrders(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;e.page&&t.append("page",e.page.toString()),e.limit&&t.append("limit",e.limit.toString()),e.status&&t.append("status",e.status);let r=t.toString();return this.client.get("/api/orders".concat(r?"?".concat(r):""))}async getClientOrder(e){return this.client.get("/api/orders/".concat(e))}constructor(e=a){this.client=e}}let c=new l;class u{async create(e,t,r){return this.client.post("/api/company/".concat(e,"/orders/").concat(t,"/measurements"),r)}async update(e,t,r,n){return this.client.put("/api/company/".concat(e,"/orders/").concat(t,"/measurements/").concat(r),n)}async updateValue(e,t,r){return this.client.put("/api/orders/".concat(e,"/measurements/").concat(t),r)}constructor(e=a){this.client=e}}new u},7535:(e,t,r)=>{"use strict";r.d(t,{OJ:()=>m,$n:()=>o,Zp:()=>i,Wu:()=>u,aR:()=>l,ZB:()=>c,kt:()=>d,As:()=>g});var n=r(3365),s=r(1521),a=r(4584);let o=e=>{let{variant:t="primary",size:r="md",loading:s=!1,disabled:o,className:i,children:l,...c}=e;return(0,n.jsxs)("button",{className:(0,a.$)("inline-flex items-center justify-center font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-gray-500"}[t],{sm:"px-3 py-2 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[r],i),disabled:o||s,...c,children:[s&&(0,n.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),l]})},i=e=>{let{children:t,className:r,padding:s="md"}=e;return(0,n.jsx)("div",{className:(0,a.$)("bg-white rounded-lg border border-gray-200 shadow-sm",{sm:"p-3",md:"p-6",lg:"p-8"}[s],r),children:t})},l=e=>{let{children:t,className:r}=e;return(0,n.jsx)("div",{className:(0,a.$)("mb-4",r),children:t})},c=e=>{let{children:t,className:r}=e;return(0,n.jsx)("h3",{className:(0,a.$)("text-lg font-semibold text-gray-900",r),children:t})},u=e=>{let{children:t,className:r}=e;return(0,n.jsx)("div",{className:(0,a.$)(r),children:t})},d=e=>{let{size:t="md",className:r}=e;return(0,n.jsx)("div",{className:(0,a.$)("animate-spin rounded-full border-b-2 border-blue-600",{sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"}[t],r)})};var h=r(7268);let p=(0,s.createContext)(void 0),m=e=>{let{children:t}=e,[r,a]=(0,s.useState)(null),[o,i]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{let e=h.R2.getCurrentUser();e&&a(e),i(!1)},[]),(0,n.jsx)(p.Provider,{value:{user:r,loading:o,login:(e,t)=>{a(t)},logout:()=>{h.R2.logout(),a(null)},isAuthenticated:!!r},children:t})},g=()=>{let e=(0,s.useContext)(p);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},7581:(e,t,r)=>{Promise.resolve().then(r.bind(r,1412))}},e=>{var t=t=>e(e.s=t);e.O(0,[851,347,870,358],()=>t(7581)),_N_E=e.O()}]);